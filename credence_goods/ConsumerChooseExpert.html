{{ block title }}
    Choose an Expert
{{ endblock }}


{{ block content }}
<style>
    .expert-list {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1em;
    }

    .expert-card {
        background-color: #f1eef6;
        text-align: center;
        border: solid;
        border-radius: 1em;
        padding-bottom: 0.3em;
        margin: 1em;
        overflow: hidden;
    }

    .expert-name {
        width: 100%;
        padding: 0.3em;
        margin-bottom: 0.3em;
        background-color: #bdc9e1;
    }
</style>

{{ include_sibling "InfoBox.html" }}

<p>Please choose which expert you want to visit. After your decision, 
    your expert will diagnose you, choose your treatment, and charge the corresponding price.‚Äù</p>

<div class="expert-list">
    <script>
        let price_vector = js_vars.price_vector;
        console.log(price_vector);
    </script>
    {% for p in group.get_players() %}
        {% if not p.is_dropout %}

            {% if p.is_expert %}


                <div class="expert-card">
                    <p class="expert-name"><b> Expert {% p.player_name %}<br>
                        {% if group.treatment_skill_visible %}[{% p.total_diagnosis_accuracy_percent %}% Accuracy] {% endif %}{% if group.treatment_skill_visible %}[{% p.ability_level %} skill]{% endif %} {% if p.investment_decision %}[has invested]{% endif %}</b></p>
                    <table class="table">
                        <thead>
                            <tr>
                            <th scope="col" colspan="2">Minor Service</th>
                            <th scope="col" colspan="2">Major Service</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>Price</th>
                                <th>Expert Profit</th>
                                <th>Price</th>
                                <th>Expert Profit</th>
                            </tr>
                            <tr>
                                <td>{% p.price_small_service %} Coins</td>
                                <td><span id="profit-small-{% p.id_in_group %}"></span> Coins</td>
                                <td>{% p.price_large_service %} Coins</td>
                                <td><span id="profit-large-{% p.id_in_group %}"></span> Coins</td>
                            </tr>
                            </tr>
                        </tbody>
                    </table>

                    <button class="btn btn-primary" name="expert_chosen" value="{% p.id_in_group %}">Choose Expert {% p.player_name %}</button>
                </div>
                
                <script>
                    document.getElementById("profit-small-{% p.id_in_group %}").innerHTML = price_vector["{% p.price_vector_chosen %}"][2]
                    document.getElementById("profit-large-{% p.id_in_group %}").innerHTML = price_vector["{% p.price_vector_chosen %}"][3]
                </script>
                
            {% endif %}


        {% endif %}    

    {% endfor %}
    <div class="expert-card">
        <p class="expert-name"><b>No Expert</b></p>
        <p>You can decide not a choose an expert. Your will not get treated and not gain coins.</p>
        <button class="btn btn-primary" name="expert_chosen" value=0>Choose no expert</button>
    </div>
</div>

{{ formfield_errors 'expert_chosen' }}

{{ endblock }}
